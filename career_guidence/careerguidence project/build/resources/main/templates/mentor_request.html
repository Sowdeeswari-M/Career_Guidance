<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find Mentor - Career Guidance Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="/dashboard">
                <i class="fas fa-graduation-cap me-2"></i>Career Guidance
            </a>
            
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/dashboard">Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/assessment-form">Take Assessment</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/career-paths">Career Paths</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="/mentor-request">Find Mentor</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/progress-summary">My Progress</a>
                    </li>
                </ul>
                
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/logout">
                            <i class="fas fa-sign-out-alt me-1"></i>Logout
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    
    <div class="container mt-4">
        <!-- Header -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card bg-gradient-warning text-dark">
                    <div class="card-body">
                        <h2 class="card-title">
                            <i class="fas fa-user-tie me-2"></i>Find Your Mentor
                        </h2>
                        <p class="card-text mb-0">Connect with experienced professionals to guide your career journey</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- My Mentorship Requests -->
        <div class="row mb-4" th:if="${!#lists.isEmpty(myRequests)}">
            <div class="col-12">
                <h4 class="mb-3">
                    <i class="fas fa-paper-plane me-2"></i>My Mentorship Requests
                </h4>
                <div class="card">
                    <div class="card-body">
                        <div th:each="request : ${myRequests}" class="border-bottom py-3">
                            <div class="row align-items-center">
                                <div class="col-md-8">
                                    <h6 class="mb-1">
                                        <span th:if="${request.mentorUser}" th:text="'Request to ' + ${request.mentorUser.fullName}">Request to Mentor</span>
                                        <span th:unless="${request.mentorUser}">General Mentorship Request</span>
                                    </h6>
                                    <p class="mb-1 text-muted small" th:text="${request.requestMessage}">Request message</p>
                                    <small class="text-muted">
                                        <i class="fas fa-calendar me-1"></i>
                                        <span th:text="${#temporals.format(request.requestDate, 'MMM dd, yyyy')}">Date</span>
                                    </small>
                                </div>
                                <div class="col-md-4 text-end">
                                    <span class="badge" 
                                          th:classappend="${request.requestStatus == 'PENDING'} ? 'bg-warning' : 
                                                         (${request.requestStatus == 'ACCEPTED'} ? 'bg-success' : 'bg-danger')"
                                          th:text="${request.requestStatus}">Status</span>
                                    <div class="mt-2" th:if="${request.requestStatus == 'ACCEPTED'}">
                                        <button class="btn btn-sm btn-outline-primary" onclick="viewMentorship(this)"
                                                th:data-id="${request.requestId}">
                                            <i class="fas fa-eye me-1"></i>View Details
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Available Mentors -->
        <div class="row">
            <div class="col-12">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h4>
                        <i class="fas fa-users me-2"></i>Available Mentors
                    </h4>
                    <div class="input-group" style="max-width: 300px;">
                        <input type="text" class="form-control" placeholder="Search by expertise..." id="mentorSearch">
                        <button class="btn btn-outline-secondary" type="button" onclick="searchMentors()">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row" th:if="${!#lists.isEmpty(availableMentors.content)}">
            <div th:each="mentor : ${availableMentors.content}" class="col-md-6 col-lg-4 mb-4">
                <div class="card h-100 shadow-sm">
                    <div class="card-body">
                        <div class="text-center mb-3">
                            <div class="avatar-circle bg-primary text-white mb-2">
                                <i class="fas fa-user fa-2x"></i>
                            </div>
                            <h5 class="card-title" th:text="${mentor.fullName}">Mentor Name</h5>
                            <p class="text-muted small" th:text="${mentor.professionalTitle}">Professional Title</p>
                            <p class="text-muted small" th:if="${mentor.companyName}">
                                <i class="fas fa-building me-1"></i>
                                <span th:text="${mentor.companyName}">Company</span>
                            </p>
                        </div>
                        
                        <div class="mb-3" th:if="${mentor.yearsOfExperience}">
                            <small class="text-muted">
                                <i class="fas fa-clock me-1"></i>
                                <span th:text="${mentor.yearsOfExperience} + ' years experience'">Experience</span>
                            </small>
                        </div>
                        
                        <div class="mb-3" th:if="${mentor.expertiseAreas}">
                            <h6 class="small text-primary">Expertise Areas:</h6>
                            <p class="small" th:text="${mentor.expertiseAreas}">Expertise areas</p>
                        </div>
                        
                        <div class="mb-3" th:if="${mentor.profileBio}">
                            <h6 class="small text-primary">About:</h6>
                            <p class="small" th:text="${#strings.abbreviate(mentor.profileBio, 100)}">Bio</p>
                        </div>
                    </div>
                    <div class="card-footer bg-transparent">
                        <button class="btn btn-primary w-100" onclick="requestMentorship(this)" 
                                th:data-id="${mentor.userId}"
                                th:data-name="${mentor.fullName}">
                            <i class="fas fa-paper-plane me-2"></i>Request Mentorship
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- No Mentors Message -->
        <div class="row" th:if="${#lists.isEmpty(availableMentors.content)}">
            <div class="col-12">
                <div class="card text-center">
                    <div class="card-body py-5">
                        <i class="fas fa-user-tie fa-4x text-muted mb-4"></i>
                        <h4 class="text-muted">No Mentors Available</h4>
                        <p class="text-muted">Check back later for available mentors or submit a general request</p>
                        <button class="btn btn-primary" onclick="submitGeneralRequest()">
                            <i class="fas fa-paper-plane me-2"></i>Submit General Request
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- General Request Button -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card border-info">
                    <div class="card-body text-center">
                        <h5 class="card-title">Can't find the right mentor?</h5>
                        <p class="card-text">Submit a general mentorship request and we'll match you with a suitable mentor</p>
                        <button class="btn btn-info" onclick="submitGeneralRequest()">
                            <i class="fas fa-paper-plane me-2"></i>Submit General Request
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Mentorship Request Modal -->
    <div class="modal fade" id="mentorshipRequestModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="requestModalTitle">Request Mentorship</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="mentorshipRequestForm">
                    <div class="modal-body">
                        <input type="hidden" id="mentorId" name="mentorId">
                        
                        <div class="mb-3">
                            <label for="requestMessage" class="form-label">
                                <i class="fas fa-comment me-1"></i>Why do you want this mentorship?
                            </label>
                            <textarea class="form-control" id="requestMessage" name="requestMessage" rows="4" 
                                      placeholder="Explain why you're interested in this mentorship and what you hope to achieve..." required></textarea>
                        </div>
                        
                        <div class="mb-3">
                            <label for="mentorshipGoals" class="form-label">
                                <i class="fas fa-target me-1"></i>Your Mentorship Goals
                            </label>
                            <textarea class="form-control" id="mentorshipGoals" name="mentorshipGoals" rows="3" 
                                      placeholder="What specific goals do you want to achieve through this mentorship?" required></textarea>
                        </div>
                        
                        <div class="mb-3">
                            <label for="preferredSchedule" class="form-label">
                                <i class="fas fa-calendar me-1"></i>Preferred Meeting Schedule
                            </label>
                            <input type="text" class="form-control" id="preferredSchedule" name="preferredMeetingSchedule" 
                                   placeholder="e.g., Weekly on weekends, Bi-weekly evenings, etc.">
                        </div>
                        
                        <div class="mb-3">
                            <label for="skillAreas" class="form-label">
                                <i class="fas fa-tools me-1"></i>Skill Areas of Interest
                            </label>
                            <input type="text" class="form-control" id="skillAreas" name="skillAreasOfInterest" 
                                   placeholder="e.g., Java programming, Career planning, Leadership skills">
                        </div>
                        
                        <div class="mb-3">
                            <label for="currentChallenges" class="form-label">
                                <i class="fas fa-exclamation-triangle me-1"></i>Current Challenges
                            </label>
                            <textarea class="form-control" id="currentChallenges" name="currentChallenges" rows="2" 
                                      placeholder="What challenges are you currently facing in your career?"></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-paper-plane me-2"></i>Send Request
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function requestMentorship(button) {
            const mentorId = button.getAttribute('data-id');
            const mentorName = button.getAttribute('data-name');
            
            document.getElementById('mentorId').value = mentorId;
            document.getElementById('requestModalTitle').textContent = `Request Mentorship from ${mentorName}`;
            
            const modal = new bootstrap.Modal(document.getElementById('mentorshipRequestModal'));
            modal.show();
        }
        
        function submitGeneralRequest() {
            document.getElementById('mentorId').value = '';
            document.getElementById('requestModalTitle').textContent = 'Submit General Mentorship Request';
            
            const modal = new bootstrap.Modal(document.getElementById('mentorshipRequestModal'));
            modal.show();
        }
        
        function searchMentors() {
            const searchTerm = document.getElementById('mentorSearch').value;
            // In a real application, this would filter mentors by expertise
            console.log('Searching for mentors with expertise:', searchTerm);
        }
        
        function viewMentorship(button) {
            const requestId = button.getAttribute('data-id');
            // In a real application, this would show mentorship details
            alert('Viewing mentorship details for request ID: ' + requestId);
        }
        
        document.getElementById('mentorshipRequestForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const requestData = Object.fromEntries(formData);
            
            // In a real application, this would submit the request via API
            console.log('Submitting mentorship request:', requestData);
            
            // Show success message
            const modal = bootstrap.Modal.getInstance(document.getElementById('mentorshipRequestModal'));
            modal.hide();
            
            const alert = document.createElement('div');
            alert.className = 'alert alert-success alert-dismissible fade show';
            alert.innerHTML = `
                <i class="fas fa-check-circle me-2"></i>
                Mentorship request submitted successfully! You will be notified when the mentor responds.
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            document.querySelector('.container').insertBefore(alert, document.querySelector('.container').firstChild);
            
            // Reset form
            this.reset();
        });
    </script>
    
    <style>
        .avatar-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
        }
        
        .card:hover {
            transform: translateY(-2px);
            transition: transform 0.2s;
        }
    </style>
</body>
</html>